{% extends 'base.html' %}

{% block title %}Projects - VulnAssesor{% endblock %}

{% block content %}
<div class="container">
    <div class="header-actions" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h1>Projects</h1>
        <a href="{% url 'project_create' %}" class="btn btn-primary" style="display: flex; align-items: center;">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 8px;">
                <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
            </svg>
            New Project
        </a>
    </div>

    <div class="grid-layout" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
        {% for project in projects %}
        <div class="card" style="background-color: #161b22; border: 1px solid #30363d; border-radius: 6px; padding: 16px;">
            <div class="card-header" style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: flex-start;">
                <h3 style="margin: 0;"><a href="{% url 'project_detail' project.id %}" style="color: #58a6ff; text-decoration: none;">{{ project.name }}</a></h3>
                <form method="post" action="{% url 'project_delete' project.id %}" onsubmit="return confirm('Are you sure you want to delete this project? This action cannot be undone.');">
                    {% csrf_token %}
                    <button type="submit" style="background: none; border: none; color: #8b949e; cursor: pointer; padding: 4px;" title="Delete Project">
                        <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z"/>
                            <path fill-rule="evenodd" d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"/>
                        </svg>
                    </button>
                </form>
            </div>
            <div class="card-body">
                {% if project.repository_url %}
                <p class="text-muted" style="color: #8b949e; display: flex; align-items: center;">
                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 4px;">
                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                    </svg>
                    {{ project.repository_url }}
                </p>
                {% else %}
                <p class="text-muted" style="color: #8b949e;">Zip Upload</p>
                {% endif %}
                <p style="color: #8b949e; font-size: 0.9em;">Last Scan: {{ project.last_scan|default:"Never" }}</p>
            </div>
        </div>
        {% empty %}
        <div class="empty-state" style="grid-column: 1 / -1; text-align: center; padding: 40px; color: #8b949e;">
            <p>No projects found. Create one to get started.</p>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
